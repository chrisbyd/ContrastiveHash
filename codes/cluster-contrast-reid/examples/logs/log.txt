==========
Args:Namespace(arch='alexnet', batch_size=60, crop_size=224, data_dir='/home/chris/research_work/my_work/ContrastiveHash/codes/cluster-contrast-reid/examples/data', dataset='imagenet', dropout=0, epochs=50, eps=0.6, eps_gap=0.02, eval_step=2, features=0, hash_bit=16, height=256, iters=400, k1=30, k2=6, logs_dir='/home/chris/research_work/my_work/ContrastiveHash/codes/cluster-contrast-reid/examples/logs', lr=0.00035, momentum=0.1, num_instances=3, pooling_type='gem', print_freq=10, seed=1, step_size=20, temp=0.05, use_hard=True, weight_decay=0.0005, width=256, workers=4)
==========
==> Load unlabeled dataset
---------------Dataset name is imagenet-----------------
---Dataset has 13000 training images---
---Dataset has 5000 query images---
---Dataset has 128503 gallery images---
---Dataset has 100 number of classes---
The batch size is 60
==> Create pseudo labels for unlabeled data
Extract Features: [50/217]	Time 0.013 (0.137)	Data 0.000 (0.118)	
Extract Features: [100/217]	Time 0.013 (0.132)	Data 0.000 (0.116)	
Extract Features: [150/217]	Time 0.013 (0.138)	Data 0.000 (0.123)	
Extract Features: [200/217]	Time 0.013 (0.136)	Data 0.000 (0.121)	
Computing jaccard distance...
Jaccard distance computing time cost: 13.538100481033325
Clustering criterion: eps: 0.600
==> Statistics for epoch 0: 71 clusters
Epoch: [0][10/400]	Time 0.593 (0.284)	Data 0.555 (0.232)	Loss 3.637 (2.979)
Epoch: [0][20/400]	Time 0.036 (0.254)	Data 0.000 (0.210)	Loss 3.671 (3.252)
Epoch: [0][30/400]	Time 0.035 (0.254)	Data 0.000 (0.212)	Loss 3.453 (3.123)
Epoch: [0][40/400]	Time 0.689 (0.270)	Data 0.649 (0.230)	Loss 2.885 (3.076)
Epoch: [0][50/400]	Time 0.036 (0.267)	Data 0.000 (0.227)	Loss 2.624 (2.926)
Epoch: [0][60/400]	Time 0.036 (0.263)	Data 0.000 (0.224)	Loss 1.732 (2.829)
Epoch: [0][70/400]	Time 0.646 (0.270)	Data 0.605 (0.231)	Loss 1.839 (2.729)
Epoch: [0][80/400]	Time 0.037 (0.268)	Data 0.000 (0.229)	Loss 2.129 (2.600)
Epoch: [0][90/400]	Time 0.036 (0.264)	Data 0.000 (0.226)	Loss 1.264 (2.526)
Epoch: [0][100/400]	Time 0.617 (0.266)	Data 0.578 (0.228)	Loss 1.298 (2.432)
Epoch: [0][110/400]	Time 0.041 (0.267)	Data 0.000 (0.228)	Loss 1.920 (2.366)
Epoch: [0][120/400]	Time 0.038 (0.268)	Data 0.000 (0.229)	Loss 2.121 (2.313)
Epoch: [0][130/400]	Time 0.694 (0.273)	Data 0.657 (0.234)	Loss 1.332 (2.254)
Epoch: [0][140/400]	Time 0.037 (0.271)	Data 0.000 (0.232)	Loss 1.814 (2.195)
Epoch: [0][150/400]	Time 0.038 (0.271)	Data 0.000 (0.232)	Loss 1.356 (2.148)
Epoch: [0][160/400]	Time 0.697 (0.274)	Data 0.659 (0.236)	Loss 1.557 (2.116)
Epoch: [0][170/400]	Time 0.038 (0.272)	Data 0.000 (0.234)	Loss 1.995 (2.069)
Epoch: [0][180/400]	Time 0.218 (0.272)	Data 0.181 (0.233)	Loss 1.536 (2.025)
Epoch: [0][190/400]	Time 0.800 (0.275)	Data 0.762 (0.237)	Loss 1.110 (1.982)
Epoch: [0][200/400]	Time 0.066 (0.273)	Data 0.028 (0.235)	Loss 1.079 (1.946)
Epoch: [0][210/400]	Time 0.036 (0.273)	Data 0.000 (0.235)	Loss 1.247 (1.909)
Epoch: [0][220/400]	Time 0.739 (0.276)	Data 0.703 (0.237)	Loss 1.187 (1.878)
Epoch: [0][230/400]	Time 0.036 (0.274)	Data 0.000 (0.235)	Loss 1.556 (1.847)
Epoch: [0][240/400]	Time 0.158 (0.273)	Data 0.122 (0.235)	Loss 1.511 (1.814)
Epoch: [0][250/400]	Time 0.806 (0.275)	Data 0.769 (0.236)	Loss 1.215 (1.787)
Epoch: [0][260/400]	Time 0.036 (0.273)	Data 0.000 (0.235)	Loss 1.043 (1.763)
Epoch: [0][270/400]	Time 0.036 (0.272)	Data 0.000 (0.234)	Loss 1.148 (1.742)
Epoch: [0][280/400]	Time 0.682 (0.273)	Data 0.640 (0.235)	Loss 1.090 (1.725)
Epoch: [0][290/400]	Time 0.038 (0.271)	Data 0.000 (0.233)	Loss 1.282 (1.706)
Epoch: [0][300/400]	Time 0.037 (0.272)	Data 0.000 (0.234)	Loss 1.443 (1.681)
Epoch: [0][310/400]	Time 0.781 (0.276)	Data 0.736 (0.238)	Loss 1.807 (1.666)
Epoch: [0][320/400]	Time 0.036 (0.276)	Data 0.000 (0.238)	Loss 1.252 (1.648)
Epoch: [0][330/400]	Time 0.036 (0.275)	Data 0.000 (0.237)	Loss 0.660 (1.628)
Epoch: [0][340/400]	Time 0.726 (0.276)	Data 0.689 (0.238)	Loss 1.181 (1.614)
Epoch: [0][350/400]	Time 0.040 (0.275)	Data 0.000 (0.237)	Loss 0.958 (1.599)
Epoch: [0][360/400]	Time 0.036 (0.274)	Data 0.000 (0.236)	Loss 1.134 (1.584)
Epoch: [0][370/400]	Time 0.769 (0.275)	Data 0.732 (0.237)	Loss 0.535 (1.565)
Epoch: [0][380/400]	Time 0.036 (0.274)	Data 0.000 (0.237)	Loss 1.308 (1.548)
Epoch: [0][390/400]	Time 0.036 (0.274)	Data 0.000 (0.236)	Loss 0.900 (1.534)
Epoch: [0][400/400]	Time 0.672 (0.275)	Data 0.635 (0.237)	Loss 1.057 (1.521)
The batch size is 60
==> Create pseudo labels for unlabeled data
Extract Features: [50/217]	Time 0.013 (0.154)	Data 0.000 (0.141)	
Extract Features: [100/217]	Time 0.013 (0.141)	Data 0.000 (0.128)	
Extract Features: [150/217]	Time 0.014 (0.146)	Data 0.000 (0.133)	
Extract Features: [200/217]	Time 0.013 (0.147)	Data 0.000 (0.134)	
Computing jaccard distance...
Jaccard distance computing time cost: 13.32353663444519
==> Statistics for epoch 1: 179 clusters
Epoch: [1][10/400]	Time 0.041 (0.186)	Data 0.000 (0.145)	Loss 3.733 (1.374)
Epoch: [1][20/400]	Time 0.041 (0.168)	Data 0.000 (0.128)	Loss 2.184 (1.952)
Epoch: [1][30/400]	Time 0.071 (0.179)	Data 0.032 (0.139)	Loss 2.294 (2.084)
Epoch: [1][40/400]	Time 0.055 (0.172)	Data 0.016 (0.133)	Loss 1.961 (2.152)
Epoch: [1][50/400]	Time 0.041 (0.185)	Data 0.000 (0.145)	Loss 3.202 (2.224)
Epoch: [1][60/400]	Time 0.041 (0.180)	Data 0.000 (0.141)	Loss 2.042 (2.235)
Epoch: [1][70/400]	Time 0.036 (0.184)	Data 0.000 (0.144)	Loss 2.439 (2.255)
Epoch: [1][80/400]	Time 0.036 (0.184)	Data 0.000 (0.144)	Loss 2.660 (2.266)
Epoch: [1][90/400]	Time 0.041 (0.189)	Data 0.000 (0.149)	Loss 1.904 (2.247)
Epoch: [1][100/400]	Time 0.041 (0.187)	Data 0.000 (0.148)	Loss 1.987 (2.229)
Epoch: [1][110/400]	Time 0.036 (0.189)	Data 0.000 (0.149)	Loss 2.224 (2.232)
Epoch: [1][120/400]	Time 0.036 (0.187)	Data 0.000 (0.147)	Loss 1.756 (2.235)
Epoch: [1][130/400]	Time 0.042 (0.190)	Data 0.000 (0.151)	Loss 1.610 (2.210)
Epoch: [1][140/400]	Time 0.042 (0.190)	Data 0.000 (0.151)	Loss 2.037 (2.202)
Epoch: [1][150/400]	Time 0.038 (0.191)	Data 0.000 (0.152)	Loss 1.718 (2.191)
Epoch: [1][160/400]	Time 0.038 (0.192)	Data 0.000 (0.153)	Loss 2.152 (2.175)
Epoch: [1][170/400]	Time 0.111 (0.195)	Data 0.061 (0.155)	Loss 2.065 (2.167)
Epoch: [1][180/400]	Time 0.038 (0.194)	Data 0.000 (0.154)	Loss 1.808 (2.158)
Epoch: [1][190/400]	Time 0.141 (0.196)	Data 0.099 (0.156)	Loss 2.723 (2.152)
Epoch: [1][200/400]	Time 0.039 (0.197)	Data 0.000 (0.156)	Loss 1.618 (2.139)
Epoch: [1][210/400]	Time 0.058 (0.200)	Data 0.017 (0.160)	Loss 1.916 (2.124)
Epoch: [1][220/400]	Time 0.041 (0.199)	Data 0.000 (0.159)	Loss 2.063 (2.111)
Epoch: [1][230/400]	Time 0.039 (0.200)	Data 0.000 (0.160)	Loss 1.210 (2.101)
Epoch: [1][240/400]	Time 0.037 (0.199)	Data 0.000 (0.159)	Loss 1.743 (2.088)
Epoch: [1][250/400]	Time 0.041 (0.201)	Data 0.000 (0.161)	Loss 1.827 (2.075)
Epoch: [1][260/400]	Time 0.038 (0.199)	Data 0.000 (0.159)	Loss 1.862 (2.064)
Epoch: [1][270/400]	Time 0.038 (0.200)	Data 0.000 (0.160)	Loss 2.128 (2.056)
Epoch: [1][280/400]	Time 0.038 (0.199)	Data 0.000 (0.159)	Loss 1.671 (2.047)
Epoch: [1][290/400]	Time 0.057 (0.201)	Data 0.019 (0.161)	Loss 1.751 (2.036)
Epoch: [1][300/400]	Time 0.041 (0.200)	Data 0.000 (0.160)	Loss 1.084 (2.026)
Epoch: [1][310/400]	Time 0.039 (0.201)	Data 0.000 (0.161)	Loss 1.811 (2.018)
Epoch: [1][320/400]	Time 0.039 (0.201)	Data 0.000 (0.160)	Loss 1.642 (2.007)
Epoch: [1][330/400]	Time 0.041 (0.203)	Data 0.000 (0.163)	Loss 2.015 (2.000)
Epoch: [1][340/400]	Time 0.041 (0.202)	Data 0.000 (0.161)	Loss 1.846 (1.991)
Epoch: [1][350/400]	Time 0.038 (0.201)	Data 0.000 (0.161)	Loss 2.076 (1.988)
Epoch: [1][360/400]	Time 0.036 (0.200)	Data 0.000 (0.160)	Loss 1.552 (1.978)
Epoch: [1][370/400]	Time 0.042 (0.202)	Data 0.000 (0.162)	Loss 1.944 (1.970)
Epoch: [1][380/400]	Time 0.193 (0.201)	Data 0.151 (0.161)	Loss 1.663 (1.964)
Epoch: [1][390/400]	Time 0.036 (0.201)	Data 0.000 (0.161)	Loss 1.581 (1.956)
Epoch: [1][400/400]	Time 0.098 (0.200)	Data 0.062 (0.160)	Loss 1.240 (1.946)
Extract Features: [50/2226]	Time 0.272 (0.155)	Data 0.258 (0.142)	
Extract Features: [100/2226]	Time 0.013 (0.148)	Data 0.000 (0.135)	
Extract Features: [150/2226]	Time 0.426 (0.157)	Data 0.413 (0.143)	
Extract Features: [200/2226]	Time 0.014 (0.157)	Data 0.000 (0.143)	
Extract Features: [250/2226]	Time 0.057 (0.161)	Data 0.043 (0.148)	
Extract Features: [300/2226]	Time 0.013 (0.160)	Data 0.000 (0.146)	
Extract Features: [350/2226]	Time 0.014 (0.157)	Data 0.000 (0.143)	
Extract Features: [400/2226]	Time 0.013 (0.155)	Data 0.000 (0.141)	
Extract Features: [450/2226]	Time 0.286 (0.155)	Data 0.267 (0.141)	
Extract Features: [500/2226]	Time 0.014 (0.154)	Data 0.000 (0.140)	
Extract Features: [550/2226]	Time 0.201 (0.156)	Data 0.188 (0.142)	
Extract Features: [600/2226]	Time 0.013 (0.157)	Data 0.000 (0.143)	
Extract Features: [650/2226]	Time 0.509 (0.157)	Data 0.496 (0.144)	
Extract Features: [700/2226]	Time 0.013 (0.156)	Data 0.000 (0.142)	
Extract Features: [750/2226]	Time 0.538 (0.155)	Data 0.519 (0.142)	
Extract Features: [800/2226]	Time 0.013 (0.154)	Data 0.000 (0.141)	
Extract Features: [850/2226]	Time 0.013 (0.154)	Data 0.000 (0.141)	
Extract Features: [900/2226]	Time 0.013 (0.154)	Data 0.000 (0.141)	
Extract Features: [950/2226]	Time 0.187 (0.156)	Data 0.174 (0.142)	
Extract Features: [1000/2226]	Time 0.014 (0.156)	Data 0.000 (0.143)	
Extract Features: [1050/2226]	Time 0.184 (0.157)	Data 0.171 (0.143)	
Extract Features: [1100/2226]	Time 0.013 (0.156)	Data 0.000 (0.143)	
Extract Features: [1150/2226]	Time 0.013 (0.156)	Data 0.000 (0.142)	
Extract Features: [1200/2226]	Time 0.013 (0.155)	Data 0.000 (0.142)	
Extract Features: [1250/2226]	Time 0.065 (0.156)	Data 0.052 (0.142)	
Extract Features: [1300/2226]	Time 0.555 (0.157)	Data 0.542 (0.143)	
Extract Features: [1350/2226]	Time 0.013 (0.157)	Data 0.000 (0.143)	
Extract Features: [1400/2226]	Time 0.418 (0.156)	Data 0.403 (0.142)	
Extract Features: [1450/2226]	Time 0.013 (0.156)	Data 0.000 (0.142)	
Extract Features: [1500/2226]	Time 0.013 (0.155)	Data 0.000 (0.141)	
Extract Features: [1550/2226]	Time 0.013 (0.155)	Data 0.000 (0.141)	
Extract Features: [1600/2226]	Time 0.014 (0.156)	Data 0.000 (0.142)	
Extract Features: [1650/2226]	Time 0.013 (0.157)	Data 0.000 (0.143)	
Extract Features: [1700/2226]	Time 0.013 (0.156)	Data 0.000 (0.142)	
Extract Features: [1750/2226]	Time 0.013 (0.156)	Data 0.000 (0.142)	
Extract Features: [1800/2226]	Time 0.013 (0.156)	Data 0.000 (0.142)	
Extract Features: [1850/2226]	Time 0.013 (0.156)	Data 0.000 (0.142)	
Extract Features: [1900/2226]	Time 0.013 (0.155)	Data 0.000 (0.142)	
Extract Features: [1950/2226]	Time 0.014 (0.156)	Data 0.000 (0.142)	
Extract Features: [2000/2226]	Time 0.014 (0.156)	Data 0.000 (0.142)	
Extract Features: [2050/2226]	Time 0.013 (0.156)	Data 0.000 (0.142)	
Extract Features: [2100/2226]	Time 0.013 (0.156)	Data 0.000 (0.142)	
Extract Features: [2150/2226]	Time 0.067 (0.156)	Data 0.054 (0.142)	
Extract Features: [2200/2226]	Time 0.014 (0.155)	Data 0.000 (0.141)	
