==========
Args:Namespace(arch='alexnet', batch_size=400, crop_size=224, data_dir='/home/chris/research_work/my_work/ContrastiveHash/codes/cluster-contrast-reid/examples/data', dataset='cifar', dropout=0, epochs=50, eps=0.6, eps_gap=0.02, eval_step=2, features=0, hash_bit=16, height=256, iters=400, k1=30, k2=6, logs_dir='/home/chris/research_work/my_work/ContrastiveHash/codes/cluster-contrast-reid/examples/logs', lr=0.00035, momentum=0.1, num_instances=10, pooling_type='gem', print_freq=10, seed=1, step_size=20, temp=0.05, use_hard=True, weight_decay=0.0005, width=256, workers=4)
==========
==> Load unlabeled dataset
---------------Dataset name is cifar-----------------
---Dataset has 5000 training images---
---Dataset has 1000 query images---
---Dataset has 54000 gallery images---
---Dataset has 10 number of classes---
The batch size is 400
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 5.054882764816284
Clustering criterion: eps: 0.600
==> Statistics for epoch 0: 126 clusters
Epoch: [0][10/400]	Time 1.320 (0.684)	Data 1.135 (0.415)	Loss 6.511 (6.245)
Epoch: [0][20/400]	Time 0.183 (0.603)	Data 0.000 (0.375)	Loss 4.765 (5.552)
Epoch: [0][30/400]	Time 0.182 (0.577)	Data 0.000 (0.363)	Loss 4.276 (5.147)
Epoch: [0][40/400]	Time 1.294 (0.594)	Data 1.104 (0.384)	Loss 4.205 (4.913)
Epoch: [0][50/400]	Time 0.192 (0.589)	Data 0.000 (0.382)	Loss 4.361 (4.774)
Epoch: [0][60/400]	Time 0.187 (0.590)	Data 0.000 (0.384)	Loss 3.941 (4.646)
Epoch: [0][70/400]	Time 1.394 (0.602)	Data 1.200 (0.397)	Loss 4.149 (4.558)
Epoch: [0][80/400]	Time 0.185 (0.594)	Data 0.000 (0.391)	Loss 4.022 (4.481)
Epoch: [0][90/400]	Time 0.195 (0.585)	Data 0.000 (0.384)	Loss 3.613 (4.406)
Epoch: [0][100/400]	Time 1.208 (0.592)	Data 1.017 (0.391)	Loss 3.768 (4.338)
Epoch: [0][110/400]	Time 0.185 (0.586)	Data 0.000 (0.386)	Loss 3.665 (4.291)
Epoch: [0][120/400]	Time 0.182 (0.581)	Data 0.000 (0.382)	Loss 3.692 (4.251)
Epoch: [0][130/400]	Time 1.314 (0.587)	Data 1.124 (0.388)	Loss 3.865 (4.208)
Epoch: [0][140/400]	Time 0.193 (0.583)	Data 0.000 (0.385)	Loss 3.841 (4.172)
Epoch: [0][150/400]	Time 0.199 (0.582)	Data 0.000 (0.384)	Loss 3.564 (4.139)
Epoch: [0][160/400]	Time 1.215 (0.586)	Data 1.020 (0.388)	Loss 3.403 (4.107)
Epoch: [0][170/400]	Time 0.187 (0.582)	Data 0.000 (0.384)	Loss 3.392 (4.075)
Epoch: [0][180/400]	Time 0.204 (0.580)	Data 0.000 (0.383)	Loss 3.761 (4.048)
Epoch: [0][190/400]	Time 1.345 (0.584)	Data 1.153 (0.387)	Loss 3.146 (4.023)
Epoch: [0][200/400]	Time 0.199 (0.583)	Data 0.000 (0.385)	Loss 3.188 (3.994)
Epoch: [0][210/400]	Time 0.192 (0.582)	Data 0.000 (0.384)	Loss 3.491 (3.969)
Epoch: [0][220/400]	Time 1.298 (0.584)	Data 1.108 (0.387)	Loss 3.510 (3.946)
Epoch: [0][230/400]	Time 0.202 (0.581)	Data 0.000 (0.384)	Loss 3.772 (3.928)
Epoch: [0][240/400]	Time 0.198 (0.580)	Data 0.000 (0.383)	Loss 3.859 (3.909)
Epoch: [0][250/400]	Time 1.401 (0.582)	Data 1.201 (0.386)	Loss 3.219 (3.888)
Epoch: [0][260/400]	Time 0.205 (0.581)	Data 0.000 (0.385)	Loss 3.584 (3.870)
Epoch: [0][270/400]	Time 0.185 (0.578)	Data 0.000 (0.382)	Loss 3.419 (3.855)
Epoch: [0][280/400]	Time 1.307 (0.581)	Data 1.120 (0.385)	Loss 3.605 (3.843)
Epoch: [0][290/400]	Time 0.211 (0.580)	Data 0.000 (0.384)	Loss 3.580 (3.826)
Epoch: [0][300/400]	Time 0.186 (0.579)	Data 0.000 (0.383)	Loss 3.358 (3.807)
Epoch: [0][310/400]	Time 1.557 (0.582)	Data 1.358 (0.386)	Loss 3.351 (3.794)
Epoch: [0][320/400]	Time 0.200 (0.580)	Data 0.000 (0.384)	Loss 3.250 (3.781)
Epoch: [0][330/400]	Time 0.189 (0.579)	Data 0.000 (0.383)	Loss 3.151 (3.768)
Epoch: [0][340/400]	Time 1.274 (0.581)	Data 1.066 (0.385)	Loss 3.404 (3.756)
Epoch: [0][350/400]	Time 0.200 (0.579)	Data 0.000 (0.384)	Loss 3.296 (3.742)
Epoch: [0][360/400]	Time 0.185 (0.578)	Data 0.000 (0.383)	Loss 3.340 (3.731)
Epoch: [0][370/400]	Time 1.422 (0.581)	Data 1.229 (0.385)	Loss 3.419 (3.719)
Epoch: [0][380/400]	Time 0.186 (0.580)	Data 0.000 (0.384)	Loss 3.479 (3.708)
Epoch: [0][390/400]	Time 0.199 (0.579)	Data 0.000 (0.383)	Loss 2.972 (3.696)
Epoch: [0][400/400]	Time 1.416 (0.581)	Data 1.207 (0.386)	Loss 3.276 (3.683)
The batch size is 400
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 5.948261737823486
==> Statistics for epoch 1: 171 clusters
Epoch: [1][10/400]	Time 0.189 (0.564)	Data 0.000 (0.365)	Loss 3.205 (2.732)
Epoch: [1][20/400]	Time 0.187 (0.504)	Data 0.000 (0.308)	Loss 3.775 (3.011)
Epoch: [1][30/400]	Time 0.194 (0.550)	Data 0.000 (0.354)	Loss 3.311 (3.123)
Epoch: [1][40/400]	Time 0.189 (0.526)	Data 0.000 (0.330)	Loss 2.821 (3.117)
Epoch: [1][50/400]	Time 0.191 (0.540)	Data 0.000 (0.344)	Loss 3.240 (3.125)
Epoch: [1][60/400]	Time 0.200 (0.526)	Data 0.000 (0.329)	Loss 3.102 (3.138)
Epoch: [1][70/400]	Time 0.188 (0.538)	Data 0.000 (0.342)	Loss 2.950 (3.122)
Epoch: [1][80/400]	Time 0.192 (0.527)	Data 0.000 (0.332)	Loss 3.052 (3.112)
Epoch: [1][90/400]	Time 0.190 (0.533)	Data 0.000 (0.337)	Loss 3.060 (3.106)
Epoch: [1][100/400]	Time 0.189 (0.528)	Data 0.000 (0.331)	Loss 2.971 (3.102)
Epoch: [1][110/400]	Time 0.190 (0.536)	Data 0.000 (0.339)	Loss 3.051 (3.093)
Epoch: [1][120/400]	Time 0.194 (0.531)	Data 0.000 (0.334)	Loss 2.960 (3.086)
Epoch: [1][130/400]	Time 0.197 (0.535)	Data 0.000 (0.338)	Loss 2.920 (3.076)
Epoch: [1][140/400]	Time 0.185 (0.530)	Data 0.000 (0.333)	Loss 2.925 (3.072)
Epoch: [1][150/400]	Time 0.201 (0.534)	Data 0.000 (0.337)	Loss 2.570 (3.056)
Epoch: [1][160/400]	Time 0.196 (0.531)	Data 0.000 (0.334)	Loss 2.815 (3.052)
Epoch: [1][170/400]	Time 0.196 (0.534)	Data 0.000 (0.337)	Loss 2.643 (3.040)
Epoch: [1][180/400]	Time 0.199 (0.532)	Data 0.000 (0.335)	Loss 3.029 (3.033)
Epoch: [1][190/400]	Time 0.188 (0.535)	Data 0.000 (0.339)	Loss 2.905 (3.024)
Epoch: [1][200/400]	Time 0.187 (0.531)	Data 0.000 (0.335)	Loss 2.789 (3.014)
Epoch: [1][210/400]	Time 0.205 (0.536)	Data 0.000 (0.340)	Loss 3.006 (3.008)
Epoch: [1][220/400]	Time 0.183 (0.532)	Data 0.000 (0.336)	Loss 2.852 (3.001)
Epoch: [1][230/400]	Time 0.189 (0.535)	Data 0.000 (0.339)	Loss 2.981 (2.993)
Epoch: [1][240/400]	Time 0.200 (0.532)	Data 0.000 (0.336)	Loss 2.678 (2.987)
Epoch: [1][250/400]	Time 0.193 (0.535)	Data 0.000 (0.339)	Loss 2.597 (2.978)
Epoch: [1][260/400]	Time 0.191 (0.531)	Data 0.000 (0.336)	Loss 2.872 (2.971)
Epoch: [1][270/400]	Time 0.209 (0.536)	Data 0.000 (0.340)	Loss 2.667 (2.965)
Epoch: [1][280/400]	Time 0.200 (0.533)	Data 0.000 (0.338)	Loss 2.778 (2.962)
Epoch: [1][290/400]	Time 0.190 (0.537)	Data 0.000 (0.341)	Loss 2.994 (2.956)
Epoch: [1][300/400]	Time 0.187 (0.534)	Data 0.000 (0.339)	Loss 2.938 (2.950)
Epoch: [1][310/400]	Time 0.186 (0.536)	Data 0.000 (0.341)	Loss 2.762 (2.945)
Epoch: [1][320/400]	Time 0.184 (0.533)	Data 0.000 (0.338)	Loss 2.775 (2.937)
Epoch: [1][330/400]	Time 0.201 (0.536)	Data 0.000 (0.341)	Loss 3.237 (2.933)
Epoch: [1][340/400]	Time 0.195 (0.535)	Data 0.000 (0.340)	Loss 2.992 (2.929)
Epoch: [1][350/400]	Time 0.197 (0.537)	Data 0.000 (0.342)	Loss 2.490 (2.923)
Epoch: [1][360/400]	Time 0.191 (0.535)	Data 0.000 (0.340)	Loss 2.595 (2.918)
Epoch: [1][370/400]	Time 0.187 (0.537)	Data 0.000 (0.342)	Loss 2.607 (2.910)
Epoch: [1][380/400]	Time 0.189 (0.536)	Data 0.000 (0.340)	Loss 2.831 (2.906)
Epoch: [1][390/400]	Time 0.186 (0.538)	Data 0.000 (0.343)	Loss 2.590 (2.901)
Epoch: [1][400/400]	Time 0.212 (0.538)	Data 0.000 (0.342)	Loss 2.706 (2.895)
Extract Features: [50/138]	Time 1.203 (0.369)	Data 1.089 (0.288)	
Extract Features: [100/138]	Time 0.217 (0.342)	Data 0.142 (0.260)	
----Mean AP-----: 20.5%

 * Finished epoch   1  model mAP: 20.5%  best: 20.5% *

The batch size is 400
==> Create pseudo labels for unlabeled data
Computing jaccard distance...
Jaccard distance computing time cost: 5.518665552139282
==> Statistics for epoch 2: 159 clusters
